install.packages("hdf5r")
library(hdf5r)
ko_data <- H5File$open("CTR9_snRNASeq/KO/filtered_feature_bc_matrix.h5", mode = "r")
h5_file <- H5File$open("CTR9_snRNASeq/KO/filtered_feature_bc_matrix.h5", mode = "r")
BiocManager::install("rhdf5")
library(rhdf5)
h5ls("CTR9_snRNASeq/KO/filtered_feature_bc_matrix.h5")
h5ls("CTR9_snRNASeq/KO/filtered_feature_bc_matrix.h5", all=TRUE)
library(Seurat)
wt <- Read10X_h5("CTR9_snRNASeq/WT/filtered_feature_bc_matrix.h5")
ko <- Read10X_h5("CTR9_snRNASeq/KO/filtered_feature_bc_matrix.h5")
wt <- CreateSeuratObject(wt, project="WT_DM")
ko <- CreateSeuratObject(ko, project="KO_DM")
wt$sample <- "WT_DM"
ko$sample <- "KO_DM"
obj <- merge(wt, y=ko)
obj <- NormalizeData(obj)
obj <- FindVariableFeatures(obj)
obj <- ScaleData(obj)
obj <- RunPCA(obj)
obj <- FindNeighbors(obj, dims=1:30)
obj <- RunUMAP(obj, dims=1:30)
DimPlot(obj, reduction="umap", group.by="sample")
library(Seurat)
wt <- Read10X_h5("CTR9_snRNASeq/WT/filtered_feature_bc_matrix.h5")
ko <- Read10X_h5("CTR9_snRNASeq/KO/filtered_feature_bc_matrix.h5")
wt <- CreateSeuratObject(wt, project="WT_DM")
ko <- CreateSeuratObject(ko, project="KO_DM")
wt$sample <- "WT_DM"
ko$sample <- "KO_DM"
obj <- merge(wt, y=ko)
obj <- NormalizeData(obj)
obj <- FindVariableFeatures(obj)
obj <- ScaleData(obj)
obj <- RunPCA(obj)
ElbowPlot(obj, ndims = 50)
obj <- FindNeighbors(obj, dims = 1:20)
obj <- FindClusters(obj, resolution = 0.5)
obj <- RunUMAP(obj, dims = 1:20)
DimPlot(obj, reduction = "umap", group.by = "sample")
DimPlot(obj, reduction = "umap", label = TRUE)
obj <- FindClusters(obj, resolution = 0.1)
DimPlot(obj)
DotPlot(obj, c("Ncr1", "Cd8a", "Cde3", "Cd4", "Foxp3", "Cd79a", "Kit", "Csf1r", "Csf3r", "S100a8", "Epcam","Krt14"))
DotPlot(obj, c("Ncr1", "Cd8a", "Cde3", "Cd4", "Foxp3", "Cd79a", "Kit", "Csf1r", "Csf3r", "S100a8", "Epcam","Krt14"))
DotPlot(obj, features = c("Ncr1", "Cd8a", "Cde3", "Cd4", "Foxp3", "Cd79a", "Kit", "Csf1r", "Csf3r", "S100a8", "Epcam","Krt14"))
DotPlot(obj, features = c("Ncr1", "Cd8a", "Cd3e", "Cd4", "Foxp3", "Cd79a", "Kit", "Csf1r", "Csf3r", "S100a8", "Epcam","Krt14"))
obj <- FindClusters(obj, resolution = 0.5)
DotPlot(obj, features = c("Ncr1", "Cd8a", "Cd3e", "Cd4", "Foxp3", "Cd79a", "Kit", "Csf1r", "Csf3r", "S100a8", "Epcam","Krt14"))
DimPlot(obj, label = T)
m <- FindAllMarkers(obj)
saveRDS(obj, file = "CTR9_snRNASeq_seurat_obj.rds")
library(Seurat)
wt <- Read10X_h5("CTR9_snRNASeq/WT/filtered_feature_bc_matrix.h5")
ko <- Read10X_h5("CTR9_snRNASeq/KO/filtered_feature_bc_matrix.h5")
wt <- CreateSeuratObject(wt, project="WT_DM")
ko <- CreateSeuratObject(ko, project="KO_DM")
wt$sample <- "WT_DM"
ko$sample <- "KO_DM"
obj <- merge(wt, y=ko)
obj <- NormalizeData(obj)
obj <- FindVariableFeatures(obj)
obj <- ScaleData(obj)
obj <- RunPCA(obj)
obj <- FindNeighbors(obj, dims = 1:20)
obj <- FindClusters(obj, resolution = 0.5)
obj <- RunUMAP(obj, dims = 1:20)
DimPlot(obj)
DotPlot(obj, features = c("Ncr1", "Cd8a", "Cd3e", "Cd4", "Foxp3", "Cd79a", "Kit", "Csf1r", "Csf3r", "S100a8", "Epcam","Krt14"))
m <- FindAllMarkers(obj)
